<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Building a collaborative audio editor based on the Web Audio API</title>

		<meta name="description" content="Building a collaborative audio editor based on the Web Audio API - Kolloquium">
		<meta name="author" content="Jan Monschke">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/default.css" id="theme">
		<link rel="stylesheet" href="css/custom.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>
		<div id="source-info"></div>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>Building a collaborative audio editor based on the Web Audio API</h1>
					<hr />
					<h3>Kolloquium</h3>
					<h4>Jan Monschke</h4>
				</section>

				<section>
					<h2>Audio im Web</h2>

					<ul class="spaced">
						<li class="fragment"><code>bgsound</code></li>
						<li class="fragment"><code>object, embed</code></li>
						<li class="fragment"><code>< audio /></code></li>
						<li class="fragment"><code>Audio Data API</code></li>
						<li class="fragment"><code>Web Audio API</code></li>
					</ul>

					<aside class="notes">
						<p>first three points mainly for playing and varying in features</p>
						<p>bgsound is kind of the blink aka marquee element of the web ;)</p>
						<p>Audio Data API gave raw audio access and some ways tom manipulate audio, but API was nut sufficient</p>
						<p>Newest addition to the family: web audio API</p>
					</aside>

				</section>

				<section>
					<h2>Web Audio API</h2>

					<ul class="spaced">
						<li class="fragment">low-level Audio Kontrolle (Buffer)</li>
						<li class="fragment">Tonerzeugung (Oszillator)</li>
						<li class="fragment">Tonmanipulation (Filter)</li>
						<li class="fragment">Präzsises Timing</li>
						<li class="fragment">Audio-Analyse, räumliche Sounds...</li>
					</ul>

					<aside class="notes">
						<p>create: literally! create sounds from waves</p>
						<p>manipulate: a rich api to create custom filters easily</p>
						<p>precision: timing is everything when dealing with more than one sound</p>
						<p>Who feels comfortable with his knowledge about the physical basics of audio?</p>
					</aside>

				</section>

				<section>
					<h2>Experimente &rarr; Tools</h2>
				</section>

				<section>
					<section>
						<h2>DAW Analyse</h2>

						<ul class="spaced">
							<li class="fragment">Viele Best Practices</li>
							<li class="fragment">Interface Patterns</li>
							<li class="fragment">Minimalumfang</li>
						</ul>

						<aside class="notes">

						</aside>
					</section>
					<section>
						<h2>Garageband</h2>

						<img src="images/garageband_screenshot.png">

						<aside class="notes">

						</aside>
					</section>

					<section>
						<h2>Ableton Live</h2>

						<img src="images/ableton_live.png" data-source="http://jdmusic.de/?p=165">

						<aside class="notes">

						</aside>
					</section>

					<section>
						<h2>Reason</h2>

						<img src="images/reason-screen.jpg" data-source="http://i1-mac.softpedia-static.com/screenshots/Reason_7.jpg">

						<aside class="notes">

						</aside>
					</section>

					<section>
						<h2>DAW</h2>

						<ul class="spaced">
							<li class="fragment">Timeline (links nach rechts)</li>
							<li class="fragment">Vorschau (waveform, patterns)</li>
							<li class="fragment">Spuren als Zeilen</li>
							<li class="fragment">Aufnehmen, Importieren, Drums, Synthesizer</li>
						</ul>

						<aside class="notes">

						</aside>
					</section>

					<section>
						<h2>Web Audio Editor</h2>

						<img src="images/editor-screen.png">

						<aside class="notes">
							<p>Demo: show track layout, each track has different type, name the three types</p>
							<p>Control buttons on the top, timeline, skip things</p>
							<p>control elements for each track</p>
							<p>canvas previews in the track elements</p>
						</aside>
					</section>

				</section>

				<section>

					<section>
						<h2>Aufnahme</h2>

						<ul class="spaced">
							<li class="fragment">Audiosignal aufnehmen</li>
							<li class="fragment">Visualisierung des Signals</li>
							<li class="fragment">Ausschnitte auswählen</li>
							<li class="fragment">Aufnahmen hochladen</li>
							<li class="fragment">Dateien importieren</li>
						</ul>


					</section>

					<section>
						<h2>Aufnahme (Screenshot)</h2>

						<img src="images/recording-a-signal.png" width="600">

					</section>

					<section>
						<h2>Aufnahme (Node Graph)</h2>

						<img src="images/Recording.png" width="700" />

						<aside class="notes">
							<p>Web Audio nodes in combination with other new web tech</p>
							<p>This is why you can't use it in IE, all modern web APIs in one place ;)</p>
						</aside>

					</section>
				</section>


				<section>

					<section>
						<h2>Drums</h2>

						<ul class="spaced">
							<li class="fragment">Kontrolle über Geschwindigkeit und Beats</li>
							<li class="fragment">Komplexe Drum Loops</li>
							<li class="fragment">Verschiedene Töne</li>
							<li class="fragment">Exaktes Timing!</li>
						</ul>

					</section>

					<section>
						<h2>Drums (Screenshot)</h2>

						<img src="images/drum-edit.png">

					</section>

					<section>
						<h2>Web Audio Timing</h2>


						<ul class="spaced">
							<li class="fragment"><del>setTimeout/setInterval</del></li>
							<li class="fragment">Eigenes Zeitsystem in der Web Audio API</li>
							<li class="fragment">Timing in eigenem Thread</li>
						</ul>

						<pre class="fragment"><code>  var node = context.createBufferSource();

  node.start(when, offset, duration);
</code></pre>


						<aside class="notes">
							
						</aside>

					</section>
				</section>

				<section>

					<section>
						<h2>Synthesizer</h2>

						<img src="images/minimoog.jpg" width="700" data-source="http://createdigitalmusic.com/files/2010/10/minimoogcloseup.jpg">

						<aside class="notes">
							<p>consists of oscillators, filters and gain control, all present in web audio api</p>
							<p>Minimoog</p>
						</aside>

					</section>

					<section>
						<h2>Oszillator</h2>
						<img src="images/sinewave.gif" data-source="http://televandalist.com/post/49335582926/61-hertz-sine-wave-tone-at-60fps">
					</section>

					<section>
					<h2>Oszillator</h2>

					<div>
						<input type="range" id="oscRange" value="200" min="0" max="2000" />
						<select id="oscSelect">
							<option value="0">Sine</option>
							<option value="1">Square</option>
							<option value="2">Sawtooth</option>
							<option value="3">Triangle</option>
						</select>
						<button id="playFromRange">Play</button>
						<button id="oscStop">Stop</button>
					</div>

					<aside class="notes">
						<p>there are several forms of waves: sine, sawtooth, triangle</p>
					</aside>

				</section>

				<script type="text/javascript">
					var oscContext = new webkitAudioContext();
					var oscOscillator = null;
					var oscSelect = document.getElementById('oscSelect');
					var oscRange = document.getElementById('oscRange');

					var playOsc = function(frequency){
						stopOsc();
						oscOscillator = oscContext.createOscillator();
						oscOscillator.type = parseInt(oscSelect.value);
						oscOscillator.frequency.value = frequency;
						oscOscillator.connect(oscContext.destination);
						oscOscillator.noteOn(0);
					};

					var stopOsc = function(){
						if(oscOscillator) oscOscillator.noteOff(0);
						oscOscillator = null;
					};

					document.getElementById('playFromRange').addEventListener('click', function(){
						playOsc(200, oscRange.value);
					});

					document.getElementById('oscStop').addEventListener('click', function(){
						stopOsc();
					});

					oscSelect.addEventListener('change', function(){
						if(oscOscillator) oscOscillator.type = parseInt(this.value);
					});

					oscRange.addEventListener('change', function(){
						if(oscOscillator) oscOscillator.frequency.value = this.value;
					});

				</script>

					<section>
						<h2>Synthesizer (Node Graph)</h2>

						<img src="images/SynthesizerNodeGraph.png" width="900" />


						<aside class="notes">
							
						</aside>

					</section>

					<section>
						<h2>Envelope / Hüllkurve</h2>

						<img src="images/ADSR_parameter.png" width="800" />

						<aside class="notes">
							
						</aside>

					</section>

					<section>
						<h2>Synthesizer Screenshot</h2>

						<img src="images/synth-settings.png">

					</section>
				</section>


				<section>

					<section>
						<h2>Scheduler</h2>

						<ul class="spaced">
							<li class="fragment">Web Audio Timing ist primitiv</li>
							<li class="fragment">Spur-Playback mittels eigenem Scheduler</li>
							<li class="fragment">Spuren und Stücke in Editor Node Graph</li>
						</ul>
					</section>

					<section>

						<h2>Scheduler-Anforderungen</h2>

						<ul class="spaced">
							<li class="fragment">Effizient (Performance)</li>
							<li class="fragment">Exakt (keine Teile auslassen)</li>
							<li class="fragment">Intelligent (Offsets)</li>
						</ul>

					</section>

					<section>
						<img src="images/Scheduler_Example.svg" width="800">
					</section>

					<section>
						<ul class="spaced">
							<li class="fragment">lookahead = 3 * tick (à 100ms)</li>
							<li class="fragment">lokales Scheduling vs. globales Scheduling</li>
							<li class="fragment">offsets werden an lokale Scheduler gegeben</li>
						</ul>
					</section>	

				</section>

				<section>

					<section>
						<h2>Kollaboration</h2>

						<ul class="spaced">
							<li class="fragment">Fern-Brainstorming</li>
							<li class="fragment">Melodie-Kollaboration</li>
							<li class="fragment">Auto-save und Auto-Backup</li>
						</ul>

					</section>

					<section>
						<h2>Locking</h2>

						<ul class="spaced">
							<li class="fragment">Entitäten bei Bearbeitung sperren</li>
							<li class="fragment">Hält kreativen Prozess auf</li>
							<li class="fragment">Frustriert</li>
							<li class="fragment">Inkonsistenz bei Paketverlust</li>
						</ul>
					</section>

					<section>
						<h2>Operational Transformation</h2>

						<img src="images/OperationalTransformation.jpg" width="500"/>

					</section>

					<section>
						<h2>Operational Transformation</h2>

						<ul class="spaced">
							<li class="fragment">De-facto Standard (Google Drive, SubEthaEdit...)</li>
							<li class="fragment">Viel Forschung</li>
							<li class="fragment">Sehr kompliziert, viele Ausnahmefälle</li>
							<li class="fragment">Anpassung für JSON notwendig</li>
						</ul>

					</section>

					<section>
						<h2>Differential Synchronization</h2>

						<img src="images/DifferentialSynchronization.jpg" width="600"/>

					</section>

					<section>
						<h2>Differential Synchronization</h2>

						<ul class="spaced">
							<li class="fragment">Ring-Synchronisierung</li>
							<li class="fragment">Konsistent bei Paketverlust (Versionierung)</li>
							<li class="fragment">Diff/Patch JSON</li>
							<li class="fragment">Gut geeignet für AngularJS</li>
						</ul>

					</section>

					<section>
						<h2>Differential Synchronization (Implementierung)</h2>

						<ul class="spaced">
							<li class="fragment">Eigenes Protokoll auf Websockets</li>
							<li class="fragment">Unabhängiges Modul im Frontend</li>
							<li class="fragment">Erste JS Implementierung</li>
							<li class="fragment">Push-Integration</li>
						</ul>
					</section>

				</section>

				<section>
					<a href="http://127.0.0.1:3000"><h1>Demonstration</h1></a>
				</section>

				<section>
					<h1>Vielen Dank für Ihre Aufmerksamkeit!</h1>
				</section>

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>
			console.log('TODO: remove demo links and add screenshot slides');

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/sources/sources.js', async: true }
				]
			});

			var context = new webkitAudioContext();
			var source = null;

			window.buffers = {};

			var loadBuffer = function(location, bufferName){
				var xhr = new XMLHttpRequest();
		    xhr.open('GET', location, true);
		    xhr.responseType = 'arraybuffer';
		    xhr.onload = function(e) {
		      context.decodeAudioData(xhr.response, function(buffer) {
		      	buffers[bufferName] = buffer;
		      });
		    };
		    xhr.send();
			};

			// loadBuffer('mixer/songs/rick2.mp3', 'rick');
			// loadBuffer('mixer/songs/wearetherejects-2.mp3', 'rejects');
			// loadBuffer('slash.mp3', 'slash');
			// loadBuffer('dot.mp3', 'dot');
			// loadBuffer('dash.mp3', 'dash');
			// loadBuffer('dotcom.mp3', 'dotcom');

			var playBuffer = function(bufferName, when, offset, duration){
				if(source) source.stop(0);
				source = context.createBufferSource();
		    source.buffer = buffers[bufferName];
		    source.connect(context.destination);
		    source.start(when + context.currentTime, offset, duration);
			};

			// document.getElementById('playWith2sdelay').addEventListener('click', function(){
			// 	playBuffer('rick', 2, 0, 15);
			// });

		</script>


	</body>
</html>
